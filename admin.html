
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Admin Panel - XIVAM</title>
  <style>
    body { background: #000; color: #0f0; font-family: monospace; text-align: center; padding: 50px; }
    input, button { padding: 8px; margin: 5px; background: #111; color: #0f0; border: 1px solid #0f0; }
    table { margin: 20px auto; border-collapse: collapse; width: 80%; }
    td, th { border: 1px solid #0f0; padding: 8px; }
  </style>
</head>
<body>
  <h2>Admin Access Code Panel</h2>
  <p>Password: <input type="password" id="adminPass"><button onclick="login()">Login</button></p>
  <div id="panel" style="display:none;">
    <h3>Add Access Code</h3>
    <input id="code" placeholder="Code">
    <input id="max" placeholder="Max Uses" type="number">
    <button onclick="addCode()">Add Code</button>
    <h3>All Codes</h3>
    <table id="codeTable"><tr><th>Code</th><th>Used</th><th>Max</th><th>Delete</th></tr></table>
  </div>

  <script>
    const pass = "Xivamxxx";
    function login() {
      if (document.getElementById("adminPass").value === pass) {
        document.getElementById("panel").style.display = "block";
      } else {
        alert("Wrong password!");
      }
    }

    function loadCodes() {
      fetch("code-manager.php?action=list")
        .then(res => res.json())
        .then(data => {
          const table = document.getElementById("codeTable");
          table.innerHTML = '<tr><th>Code</th><th>Used</th><th>Max</th><th>Delete</th></tr>';
          Object.entries(data).forEach(([code, info]) => {
            const row = `<tr><td>${code}</td><td>${info.used}</td><td>${info.max}</td>
              <td><button onclick="deleteCode('${code}')">‚ùå</button></td></tr>`;
            table.innerHTML += row;
          });
        });
    }

    function addCode() {
      const code = document.getElementById("code").value;
      const max = document.getElementById("max").value;
      fetch("code-manager.php", {
        method: "POST",
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: `action=add&code=${code}&max=${max}`
      }).then(() => loadCodes());
    }

    function deleteCode(code) {
      fetch("code-manager.php", {
        method: "POST",
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: `action=delete&code=${code}`
      }).then(() => loadCodes());
    }

    // Load codes when admin panel opens
    document.addEventListener("DOMContentLoaded", () => {
      setTimeout(() => loadCodes(), 1000);
    });
  </script>
</body>
</html>
